{% extends "base.html" %}

{% block title %}Dashboard Produkcyjny{% endblock %}

{% block styles %}
<style>
    .status-indicator {
        display: inline-block;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 8px;
    }
    .status-ok { background-color: #28a745; }
    .status-idle { background-color: #ffc107; }
    .status-alarm { background-color: #dc3545; }
    .card-reaktor .card-body { font-size: 1.1rem; }
</style>
{% endblock %}


{% block content %}
<div class="container-fluid mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Pulpit Operatora</h1>
        <span class="badge bg-secondary" id="last-updated-time">Ładowanie...</span>
    </div>

    <!-- Sekcja Alarmów -->
    <div id="alarms-container" class="mb-4">
        <!-- Alarmy będą wstawiane tutaj -->
    </div>
    <div class="card mb-4">
        <div class="card-header">
            Dostępne Reaktory (Puste)
        </div>
        <div class="card-body">
            <div id="puste-reaktory-container" class="d-flex flex-wrap gap-2">
                <span class="text-muted">Ładowanie...</span>
            </div>
        </div>
    </div>
    <!-- SEKCJA REAKTORÓW -->
    <h2 class="mb-3">Reaktory w Procesie</h2>
    <div id="reaktory-container" class="row g-4">
        <!-- Karty reaktorów będą wstawiane tutaj -->
        <p>Ładowanie stanu reaktorów...</p>
    </div>

    <hr class="my-5">

    <h2 class="mb-3">Stan Magazynu</h2><div class="row mb-5">
        <div class="col-md-12">
            <h2 class="mb-3">Stan Magazynu Surowców</h2>
            <div id="stock-summary-container">
                <p>Ładowanie podsumowania...</p>
            </div>
        </div>
    </div>
    
    <!-- SEKCJE BECZEK -->
    <div class="row">
        <div class="col-md-6">
            <h2 class="mb-3">Beczki Brudne (Surowiec)</h2>
            <div id="beczki-brudne-container" class="list-group">
                <!-- Lista beczek będzie wstawiana tutaj -->
                <p>Ładowanie stanu beczek...</p>
            </div>
        </div>
        <div class="col-md-6">
            <h2 class="mb-3">Beczki Czyste (Produkt)</h2>
            <div id="beczki-czyste-container" class="list-group">
                 <!-- Lista beczek będzie wstawiana tutaj -->
                 <p>Ładowanie stanu beczek...</p>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="plan-transfer-modal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Nowy transfer z <span class="fw-bold" id="plan-transfer-source-name"></span></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="plan-transfer-form">
            <input type="hidden" id="plan-transfer-source-id">
            <div class="mb-3">
              <label class="form-label">Wybierz pusty reaktor docelowy:</label>
              <div id="plan-transfer-destinations-container">
                <!-- Opcje będą wstawiane tutaj przez JavaScript -->
              </div>
            </div>
            <button type="submit" class="btn btn-success">Rozpocznij Transfer</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="start-heating-modal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Rozpocznij podgrzewanie w <span class="fw-bold" id="start-heating-sprzet-name"></span></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="start-heating-form">
            <input type="hidden" id="start-heating-sprzet-id">
            <div class="mb-3">
              <label for="start-heating-temp" class="form-label">Podaj aktualną temperaturę wsadu (°C):</label>
              <input type="number" class="form-control" id="start-heating-temp" step="0.1" required>
            </div>
            <button type="submit" class="btn btn-warning">Rozpocznij Podgrzewanie</button>
          </form>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}